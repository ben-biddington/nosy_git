#!/usr/bin/ruby

STDOUT.sync = true

the_file = ARGV[0]

require File.join File.dirname(__FILE__), "..", "lib", "nosy_git"

class UI
  class << self
    def die(because)
      print because
      exit 1
    end
    def print what; puts what; end
  end
end

if Git.has_changes?
  UI.die "You have changes, aborting" 
end

unless File.file? the_file
  UI.die "#{the_file} is not a file"
end

puts "(#{FileUtils.pwd})"
puts "Analyzing <#{the_file}>"

NosyGit.analyze the_file
